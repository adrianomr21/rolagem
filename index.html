<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Bookmarklet Interativo</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f4f7f9;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .container {
            background-color: #fff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }
        h1, h2 {
            color: #1d3557; /* Azul escuro */
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
        }
        h1 { font-size: 2em; }
        h2 { font-size: 1.5em; margin-top: 30px; }
        code {
            background-color: #f1faee;
            color: #1d3557;
            padding: 2px 5px;
            border-radius: 4px;
            font-family: "SF Mono", "Fira Code", "Consolas", monospace;
        }
        textarea {
            width: 100%;
            min-height: 150px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 6px;
            font-family: "SF Mono", "Fira Code", "Consolas", monospace;
            font-size: 0.9em;
            resize: vertical;
        }
        .instructions ol {
            padding-left: 20px;
        }
        .instructions li {
            margin-bottom: 10px;
        }
        .bookmarklet-code {
            margin-top: 15px;
        }
        .highlight {
            color: #e63946; /* Vermelho */
            font-weight: bold;
        }
        .final-step {
            background-color: #f1faee;
            border: 1px solid #a8dadc;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Captura de Página Interativa (Versão Final)</h1>
        <p>Esta é a versão final e mais poderosa da ferramenta. Ela permite que você <span class="highlight">escolha qual parte da página capturar</span>, resolvendo o problema de sites com múltiplas áreas de rolagem.</p>

        <div class="instructions">
            <h2>Passo 1: Copie o Código Final</h2>
            <p>Selecione e copie todo o código da caixa de texto abaixo. Este código é diferente e mais inteligente que os anteriores.</p>
            <div class="bookmarklet-code">
                <textarea id="bookmarklet-code" readonly>javascript:(function(){var s=document.createElement('style');s.id='h2c-bm-style';s.innerHTML='[data-h2c-bm-highlight]:hover{outline:3px solid #e63946 !important;background-color:rgba(230,57,70,0.2) !important;cursor:pointer;}';document.head.appendChild(s);var o=document.createElement('div');o.style.cssText='position:fixed;top:20px;left:50%;transform:translateX(-50%);padding:12px 25px;background-color:rgba(29,53,87,0.95);color:white;border-radius:8px;z-index:99999;font-size:16px;font-family:sans-serif;text-align:center;box-shadow:0 4px 12px rgba(0,0,0,0.3);';o.innerHTML='<span style="font-weight:bold;">Modo de Seleção:</span> Passe o mouse e <strong>CLIQUE</strong> na área de rolagem para capturar.';document.body.appendChild(o);function a(e){document.querySelectorAll('[data-h2c-bm-highlight]').forEach(function(t){t.removeAttribute('data-h2c-bm-highlight')});if(e.target!==o&&!o.contains(e.target)){e.target.setAttribute('data-h2c-bm-highlight','true')}}document.body.addEventListener('mousemove',a);function c(e){e.preventDefault();e.stopPropagation();var t=e.target;document.body.removeEventListener('mousemove',a);document.body.removeEventListener('click',c,true);document.querySelectorAll('[data-h2c-bm-highlight]').forEach(function(e){e.removeAttribute('data-h2c-bm-highlight')});var l=document.getElementById('h2c-bm-style');if(l){l.remove()}o.innerHTML='Carregando...';function n(s,c){var e=document.createElement('script');e.src=s;e.onload=c;document.head.appendChild(e)}n('https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js',function(){n('https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js',function(){o.innerHTML='Capturando elemento...';var{jsPDF:e}=window.jspdf;html2canvas(t,{useCORS:true,allowTaint:true,height:t.scrollHeight,width:t.scrollWidth}).then(function(c){o.innerHTML='Gerando PDF...';var n=c.width,d=c.height,i=n>d?'l':'p',r=new e({orientation:i,unit:'px',format:[n,d],hotfixes:['px_scaling']});r.addImage(c.toDataURL('image/jpeg',0.95),'JPEG',0,0,n,d);r.save('captura-de-elemento.pdf');document.body.removeChild(o)}).catch(function(e){console.error('Erro no html2canvas:',e);o.style.backgroundColor='#e63946';o.innerHTML='Erro ao capturar. Verifique o console (F12).';setTimeout(function(){if(o.parentNode){document.body.removeChild(o)}},5000)})})})}document.body.addEventListener('click',c,true)})();</textarea>
            </div>

            <h2>Passo 2: Crie ou Atualize seu Favorito</h2>
            <ol>
                <li>Se você já criou o favorito antes, edite-o. Clique com o botão direito sobre ele e escolha "Editar".</li>
                <li>No campo <strong>"URL"</strong>, apague todo o código antigo e cole este novo código.</li>
                <li>Se for criar um novo, o processo é o mesmo: crie um favorito, dê um nome (ex: <code>Captura Interativa</code>) e cole o código na URL.</li>
                <li>Salve.</li>
            </ol>
        </div>

        <div class="final-step">
            <h2>Passo 3: Como Usar a Ferramenta Interativa</h2>
            <ol>
                <li>Vá para a página complexa que você quer capturar.</li>
                <li>Clique no seu favorito <strong>"Captura Interativa"</strong>.</li>
                <li>A página entrará em "Modo de Seleção". Passe o mouse sobre as áreas da página e veja elas sendo destacadas.</li>
                <li><span class="highlight">Clique exatamente sobre a área que contém o conteúdo e a barra de rolagem.</span></li>
                <li>Aguarde. A ferramenta irá capturar todo o conteúdo daquele elemento específico e iniciará o download do PDF.</li>
            </ol>
        </div>
    </div>
</body>
</html>
